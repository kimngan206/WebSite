<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>Li√™n H·ªá - AnhEm Motor</title>
    <link rel="stylesheet" href="contact.css">
    <link rel="stylesheet" href="index-style.css">
    <!-- Th∆∞ vi·ªán xu·∫•t Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <div class="header-container">
                <!-- Mobile Menu Toggle -->
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>

                <!-- Logo -->
                <a href="index.html" class="logo">
                    <div class="logo-icon">
                        <img src="image/logo.png" alt="AnhEm Motor">
                    </div>
                    <span class="logo-text">AnhEm Motor</span>
                </a>


                <!-- Desktop Navigation -->
                <nav class="main-nav">
                    <ul>
                        <li><a href="index.html">Trang Ch·ªß</a></li>
                        <li class="has-submenu">
                            <a href="listings.html">
                                S·∫£n Ph·∫©m <i class="fas fa-chevron-down"></i>
                            </a>
                            <ul class="submenu">
                                <li><a href="accessory.html">N√≥n B·∫£o Hi·ªÉm</a></li>
                                <li><a href="custome.html">Trang Ph·ª•c</a></li>
                                <li><a href="chemicals.html">H√≥a Ch·∫•t</a></li>
                                <li><a href="spareparts.html">Ph·ª• T√πng</a></li>
                            </ul>
                        </li>
                        <li><a href="about.html">Gi·ªõi Thi·ªáu</a></li>
                        <li><a href="news.html">Tin T·ª©c-S·ª± Ki·ªán</a></li>
                        <li><a href="promotion.html">Khuy·∫øn M√£i</a></li>
                        <li><a href="contact.html">Li√™n H·ªá</a></li>
                        <li><a href="service.html">D·ªãch V·ª•</a></li>
                    </ul>
                </nav>


            </div>
        </div>

        <!-- Mobile Navigation Overlay -->
        <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>

        <!-- Mobile Navigation Menu -->
        <nav class="mobile-nav" id="mobileNav">
            <div class="mobile-nav-header">
                <h3>Menu</h3>
                <button class="mobile-nav-close" id="mobileNavClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <ul>
                <li><a href="index.html">Trang Ch·ªß</a></li>
                <li><a href="listings.html">S·∫£n Ph·∫©m</a></li>
                <li><a href="about.html">Gi·ªõi Thi·ªáu</a></li>
                <li><a href="news.html">Tin T·ª©c-S·ª± Ki·ªán</a></li>
                <li><a href="promotion.html">Khuy·∫øn M√£i</a></li>
                <li><a href="contact.html">Li√™n H·ªá</a></li>
                <li><a href="service.html">D·ªãch V·ª•</a></li>
            </ul>
        </nav>
    </header>

    <div class="main-container">
        <div class="form-wrapper">
            <div class="info-section">
                <h2>Li√™n H·ªá V·ªõi Ch√∫ng T√¥i</h2>
                <p>
                    Chuy√™n cung c·∫•p v√† mua b√°n c√°c lo·∫°i xe m√°y ch√≠nh h√£ng v·ªõi gi√° t·ªët nh·∫•t th·ªã tr∆∞·ªùng. ƒê·ªôi ng≈© t∆∞ v·∫•n
                    chuy√™n nghi·ªáp s·∫µn s√†ng h·ªó tr·ª£ b·∫°n 24/7.
                </p>

                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP.HCM</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span>0901 234 567</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>info@anhemmotor.vn</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-clock"></i>
                        <span>8:00 - 22:00 (H√†ng ng√†y)</span>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3>G·ª≠i Y√™u C·∫ßu T∆∞ V·∫•n</h3>
                <p class="subtitle">ƒêi·ªÅn th√¥ng tin ƒë·ªÉ nh·∫≠n t∆∞ v·∫•n mi·ªÖn ph√≠</p>

                <form id="contactForm" novalidate>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="full_name" class="required">H·ªç v√† t√™n</label>
                            <input type="text" id="full_name" name="full_name" required>
                            <div class="error-message" id="full_name-error">Vui l√≤ng nh·∫≠p h·ªç v√† t√™n</div>
                        </div>
                        <div class="form-group">
                            <label for="phone_number" class="required">S·ªë ƒëi·ªán tho·∫°i</label>
                            <input type="tel" id="phone_number" name="phone_number" required>
                            <div class="error-message" id="phone_number-error">Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i h·ª£p l·ªá</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email">
                            <div class="error-message" id="email-error">Email kh√¥ng h·ª£p l·ªá</div>
                        </div>
                        <div class="form-group">
                            <label for="request_type" class="required">Lo·∫°i y√™u c·∫ßu</label>
                            <select id="request_type" name="request_type" required>
                                <option value="">-- Ch·ªçn lo·∫°i y√™u c·∫ßu --</option>
                                <option value="mua-xe">Mua xe m√°y</option>
                                <option value="ban-xe">B√°n xe m√°y</option>
                                <option value="bao-hanh">B·∫£o h√†nh/S·ª≠a ch·ªØa</option>
                                <option value="tu-van">T∆∞ v·∫•n chung</option>
                                <option value="khac">Kh√°c</option>
                            </select>
                            <div class="error-message" id="request_type-error">Vui l√≤ng ch·ªçn lo·∫°i y√™u c·∫ßu</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="car_type">Lo·∫°i xe quan t√¢m</label>
                            <select id="car_type" name="car_type">
                                <option value="">-- Ch·ªçn lo·∫°i xe --</option>
                                <option value="xe-so">Xe s·ªë (Honda Wave, Yamaha Sirius...)</option>
                                <option value="xe-ga">Xe ga (Honda SH, Yamaha Janus...)</option>
                                <option value="xe-con-tay">Xe c√¥n tay (Exciter, Winner...)</option>
                                <option value="xe-phan-khoi-lon">Xe ph√¢n kh·ªëi l·ªõn (CBR, R15...)</option>
                                <option value="xe-dien">Xe ƒëi·ªán</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="budget">Ng√¢n s√°ch d·ª± ki·∫øn</label>
                            <select id="budget" name="budget">
                                <option value="">-- Ch·ªçn m·ª©c gi√° --</option>
                                <option value="duoi-20tr">D∆∞·ªõi 20 tri·ªáu</option>
                                <option value="20-40tr">20 - 40 tri·ªáu</option>
                                <option value="40-60tr">40 - 60 tri·ªáu</option>
                                <option value="60-100tr">60 - 100 tri·ªáu</option>
                                <option value="tren-100tr">Tr√™n 100 tri·ªáu</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="detailed_message">Tin nh·∫Øn chi ti·∫øt</label>
                        <textarea id="detailed_message" name="detailed_message" rows="4"
                            placeholder="M√¥ t·∫£ chi ti·∫øt y√™u c·∫ßu c·ªßa b·∫°n (t√¨nh tr·∫°ng xe, th·ªùi gian mong mu·ªën, y√™u c·∫ßu ƒë·∫∑c bi·ªát...)"></textarea>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        <span class="loading-spinner" id="loadingSpinner"></span>
                        <span id="submitText">G·ª¨I Y√äU C·∫¶U T∆Ø V·∫§N</span>
                    </button>

                    <div class="form-status" id="formStatus"></div>
                </form>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            ¬© 2025 AnhEm Moto. M·ªçi quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.
        </div>
    </footer>

    <script>
        const form = document.getElementById("contactForm");
        const submitBtn = document.getElementById("submitBtn");
        const loadingSpinner = document.getElementById("loadingSpinner"); // Changed ID from 'loading' to 'loadingSpinner' to match HTML
        const submitText = document.getElementById("submitText");
        const formStatus = document.getElementById("formStatus"); // Changed ID from 'global-feedback' to 'formStatus' to match HTML

        // Helper function to display/hide error messages
        function showFieldError(elementId, message, isValid) {
            const inputElement = document.getElementById(elementId);
            const errorElement = document.getElementById(`${elementId}-error`);
            const formGroup = inputElement ? inputElement.closest('.form-group') : null;

            if (isValid) {
                if (errorElement) errorElement.style.display = 'none';
                if (formGroup) formGroup.classList.remove('invalid');
            } else {
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.style.display = 'block';
                }
                if (formGroup) formGroup.classList.add('invalid');
            }
        }

        // Email validation regex (basic)
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // Phone number validation regex (for Vietnam, 9-11 digits starting with 0)
        function isValidPhone(phone) {
            return /^0[3-9]\d{8,9}$/.test(phone); // Starts with 0, second digit 3-9, then 8 or 9 more digits
        }

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            let isFormValid = true;

            // Clear previous errors
            ['full_name', 'email', 'phone_number', 'request_type'].forEach(id => {
                showFieldError(id, '', true);
            });
            formStatus.style.display = 'none'; // Clear global message

            // Get form data
            const formData = {
                full_name: document.getElementById("full_name").value.trim(),
                email: document.getElementById("email").value.trim(),
                phone_number: document.getElementById("phone_number").value.trim(),
                request_type: document.getElementById("request_type").value,
                car_type: document.getElementById("car_type").value,
                budget: document.getElementById("budget").value,
                detailed_message: document.getElementById("detailed_message").value.trim()
            };

            // Validate full_name
            if (formData.full_name === "") {
                showFieldError('full_name', 'Vui l√≤ng nh·∫≠p h·ªç v√† t√™n c·ªßa b·∫°n.', false);
                isFormValid = false;
            }

            // Validate phone_number
            if (formData.phone_number === "") {
                showFieldError('phone_number', 'Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i.', false);
                isFormValid = false;
            } else if (!isValidPhone(formData.phone_number)) {
                showFieldError('phone_number', 'S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá (v√≠ d·ª•: 0912345678).', false);
                isFormValid = false;
            }

            // Validate email (optional, but if filled, must be valid)
            if (formData.email !== "" && !isValidEmail(formData.email)) {
                showFieldError('email', 'Email kh√¥ng h·ª£p l·ªá (v√≠ d·ª•: example@domain.com).', false);
                isFormValid = false;
            }

            // Validate request_type
            if (formData.request_type === "") {
                showFieldError('request_type', 'Vui l√≤ng ch·ªçn lo·∫°i y√™u c·∫ßu.', false);
                isFormValid = false;
            }

            if (!isFormValid) {
                // If form is not valid, stop submission
                return;
            }

            // Disable submit button and show loading spinner
            submitBtn.disabled = true;
            loadingSpinner.style.display = 'inline-block';
            submitText.textContent = 'ƒêang g·ª≠i...';

            try {
                const res = await fetch("https://backend-xolq.onrender.com/api/contacts", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(formData) // Send the collected formData
                });

                const data = await res.json();
                if (data.success) {
                    showGlobalFeedback("üéâ G·ª≠i li√™n h·ªá th√†nh c√¥ng! Ch√∫ng t√¥i s·∫Ω s·ªõm li√™n h·ªá v·ªõi b·∫°n.", true);
                    form.reset(); // Clear the form
                } else {
                    showGlobalFeedback(data.message, false);
                }
            } catch (err) {
                console.error("L·ªói khi g·ª≠i form:", err);
                showGlobalFeedback("Kh√¥ng th·ªÉ k·∫øt n·ªëi server ho·∫∑c c√≥ l·ªói m·∫°ng!", false);
            } finally {
                submitBtn.disabled = false;
                loadingSpinner.style.display = 'none';
                submitText.textContent = 'G·ª¨I Y√äU C·∫¶U T∆Ø V·∫§N';
            }
        });

        // Function to show global feedback (at the bottom of the form)
        function showGlobalFeedback(msg, isSuccess) {
            formStatus.textContent = msg;
            formStatus.style.display = "block";
            formStatus.style.background = isSuccess ? "#e8f9f0" : "#fcebeb";
            formStatus.style.color = isSuccess ? "#27ae60" : "#e74c3c";
            setTimeout(() => formStatus.style.display = "none", 2000); // Hide after 5 seconds
        }
    </script>

</body>

</html>